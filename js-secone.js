document.addEventListener("DOMContentLoaded",()=>{const counters=document.querySelectorAll(".counter");if(counters.length>0){const observerCounter=new IntersectionObserver((entries,observer)=>{entries.forEach(entry=>{if(entry.isIntersecting){const counter=entry.target;const target=+counter.getAttribute("data-target");const speed=200;const updateCount=()=>{const count=+counter.innerText;const inc=target/speed;if(count<target){counter.innerText=Math.ceil(count+inc);setTimeout(updateCount,20)}else{counter.innerText=target}};updateCount();observer.unobserve(counter)}})},{threshold:0.5});counters.forEach(counter=>observerCounter.observe(counter))}
const cards=document.querySelectorAll('.course-card');if(cards.length>0){let targetLinks={};cards.forEach(card=>{if(card.hasAttribute('data-url')){let cleanUrl=card.getAttribute('data-url').split('?')[0];targetLinks[cleanUrl]=card}});fetch('/feeds/posts/summary?alt=json&max-results=500').then(response=>response.json()).then(data=>{if(!data.feed||!data.feed.entry)return;data.feed.entry.forEach(entry=>{let postLink="";for(let k=0;k<entry.link.length;k++){if(entry.link[k].rel==='alternate'){postLink=entry.link[k].href.split('?')[0];break}}
if(targetLinks[postLink]){let card=targetLinks[postLink];let imgEl=card.querySelector('.course-img');let placeholder=card.querySelector('.course-thumb-placeholder');let thumbUrl="https://via.placeholder.com/400x250/eee/999?text=No+Image";if(entry.media$thumbnail){thumbUrl=entry.media$thumbnail.url.replace(/\/s[0-9]+(-c)?\//,'/w400-h250-c/')}
if(imgEl){imgEl.src=thumbUrl;imgEl.onload=function(){imgEl.classList.remove('hidden');if(placeholder)placeholder.style.display='none'}}}})}).catch(err=>console.log("Feed fetch skipped"))}
const elementsToAnimate=document.querySelectorAll('article, .post, .widget, img, h1, h2, h3, .card, .post-body');if(elementsToAnimate.length>0){const observerReveal=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.classList.add('active');observerReveal.unobserve(entry.target)}})},{threshold:0.15,rootMargin:"0px 0px -50px 0px"});elementsToAnimate.forEach(el=>{el.classList.add('reveal-element');observerReveal.observe(el)})}
var myBtn=document.getElementById("myUniqueScrollBtn");if(myBtn){window.addEventListener("scroll",function(){if(window.scrollY>300){myBtn.classList.add("visible")}else{myBtn.classList.remove("visible")}});myBtn.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})})}
const yearElement=document.getElementById("year-now");if(yearElement)yearElement.innerText=new Date().getFullYear();const myUrl="https://motawir-dzair.blogspot.com/";const myName="مطور دزاير";const devLink=document.getElementById("dz-dev-link");const devContainer=document.getElementById("developer-rights");function protectMyRights(){if(!devLink||!devContainer)return;if(devLink.getAttribute("href")!==myUrl||devLink.innerText!==myName||getComputedStyle(devContainer).display==="none"||getComputedStyle(devContainer).visibility==="hidden"||getComputedStyle(devLink).opacity==="0"){window.location.replace(myUrl)}}
if(devLink&&devContainer){protectMyRights();setInterval(protectMyRights,4000)}})
